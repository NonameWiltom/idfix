{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Query and fix invalid object attributes with the IdFix tool \u00b6 What is the IdFix tool? \u00b6 Microsoft is working to reduce the time required to remediate identity issues when onboarding to Microsoft 365. A portion of this effort is intended to address the time involved in remediating the Windows Server Active Directory (Windows Server AD) errors reported by the directory synchronization tools such as Azure AD Connect and Azure AD Connect cloud sync. The focus of IdFix is to enable you to accomplish this task in a simple, expedient fashion. The IdFix tool provides you the ability to query, identify, and remediate the majority of object synchronization errors in your Window\u2019s Server AD forests in preparation for deployment to Microsoft 365. The utility does not fix all errors, but it does find and fix the majority. This remediation will then allow you to successfully synchronize users, contacts, and groups from on-premises Active Directory into Microsoft 365. Note: IdFix might identify errors beyond those that emerge during synchronization. The most common example is compliance with rfc 2822 for smtp addresses. Although invalid attribute values can be synchronized to the cloud, the product group recommends that these errors be corrected. How it works \u00b6 IdFix queries all domains in the currently authenticated forest and displays object attribute values that would be reported as errors by the supported directory synchronization tool. The DataGrid view supports the ability to scroll, sort, and edit those objects in a resulting table to produce compliant values. Confirmed values can then be applied to the forest with the ability to undo updates. Transaction rollback is supported. In the case of invalid characters, a suggested \u201cfix\u201d is displayed where it can be determined from the existing value. Changes are applied only to records for which you have set an ACTION value. Confirmation of each change is enforced. Suggested values for formatting errors start with the removal of invalid characters and then the value must be updated by you. It is beyond the scope of this utility to determine what you wanted when a mistake in formatting is detected. Data can be exported into CSV or LDF format for offline editing or investigation. Save to File is supported. Because IdFix makes changes in your on-premises environment, logging is included. Verbose logging is enabled by default.","title":"Overview"},{"location":"#query-and-fix-invalid-object-attributes-with-the-idfix-tool","text":"","title":"Query and fix invalid object attributes with the IdFix tool"},{"location":"#what-is-the-idfix-tool","text":"Microsoft is working to reduce the time required to remediate identity issues when onboarding to Microsoft 365. A portion of this effort is intended to address the time involved in remediating the Windows Server Active Directory (Windows Server AD) errors reported by the directory synchronization tools such as Azure AD Connect and Azure AD Connect cloud sync. The focus of IdFix is to enable you to accomplish this task in a simple, expedient fashion. The IdFix tool provides you the ability to query, identify, and remediate the majority of object synchronization errors in your Window\u2019s Server AD forests in preparation for deployment to Microsoft 365. The utility does not fix all errors, but it does find and fix the majority. This remediation will then allow you to successfully synchronize users, contacts, and groups from on-premises Active Directory into Microsoft 365. Note: IdFix might identify errors beyond those that emerge during synchronization. The most common example is compliance with rfc 2822 for smtp addresses. Although invalid attribute values can be synchronized to the cloud, the product group recommends that these errors be corrected.","title":"What is the IdFix tool?"},{"location":"#how-it-works","text":"IdFix queries all domains in the currently authenticated forest and displays object attribute values that would be reported as errors by the supported directory synchronization tool. The DataGrid view supports the ability to scroll, sort, and edit those objects in a resulting table to produce compliant values. Confirmed values can then be applied to the forest with the ability to undo updates. Transaction rollback is supported. In the case of invalid characters, a suggested \u201cfix\u201d is displayed where it can be determined from the existing value. Changes are applied only to records for which you have set an ACTION value. Confirmation of each change is enforced. Suggested values for formatting errors start with the removal of invalid characters and then the value must be updated by you. It is beyond the scope of this utility to determine what you wanted when a mistake in formatting is detected. Data can be exported into CSV or LDF format for offline editing or investigation. Save to File is supported. Because IdFix makes changes in your on-premises environment, logging is included. Verbose logging is enabled by default.","title":"How it works"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/","text":"Errors supported by the IdFix tool \u00b6 Multi-Tenant Errors \u00b6 All objects \u00b6 Well known exclusions Admini* CAS_{* DiscoverySearchMailbox* FederatedEmail* Guest* HTTPConnector* krbtgt* iusr_* iwam* msol* support_* SystemMailbox* WWIOadmini* *$ distinguishedName contains \u201c\\0ACNF:\u201d contains IsCriticalSystemObject mail \u00b6 no duplicates mailNickName \u00b6 may not begin with a period no duplicates proxyAddresses \u00b6 invalid chars whitespace < > ( ) ; , [ ] \u201c rfc2822 & routable namespace (smtp only) no duplicates single value maximum number of characters: 256 sAMAccountName (only if no userPrincipalName value) \u00b6 invalid chars [ \\ \u201c | , / : < > + = ; ? * ] no duplicates maximum number of characters: 20 targetAddress \u00b6 invalid chars whitespace \\ < > ( ) ; , [ ] \u201c rfc2822 & routable namespace (smtp only) no duplicates maximum number of characters: 255 userPrincipalName \u00b6 invalid chars whitespace \\ % & * + / = ? { } | < > ( ) ; : , [ ] \u201c and umlaut rfc2822 & routable namespace format no duplicates maximum number of characters: 113 less than 64 before @ less than 48 after @ Dedicated Errors \u00b6 All objects \u00b6 Well known exclusions Admini* CAS_{* DiscoverySearchMailbox* FederatedEmail* Guest* HTTPConnector* krbtgt* iusr_* iwam* msol* support_* SystemMailbox* WWIOadmini* *$ distinguishedName contains \u201c\\0ACNF:\u201d contains IsCriticalSystemObject displayName \u00b6 not blank (group) no leading or trailing white space less than 256 mail \u00b6 no white space rfc2822 & routable namespace no duplicates less than 256 mailNickName \u00b6 not blank (contact and user) invalid chars whitespace \\ ! # $ % & * + / = ? ^ ` { } | ~ < > ( ) ' ; : , [ ] \" @ may not begin or end with a period less than 64 proxyAddresses \u00b6 DEPRECATED - no leading or trailing white space rfc2822 & routable namespace (smtp only) no duplicates single value maximum number of characters: 256 targetAddress \u00b6 not blank (contact and user without homeMdb) DEPRECATED - invalid chars whitespace rfc2822 & routable namespace (smtp only) DEPRECATED - no duplicates less than 256 value = mail (contact and user [if no homeMdb])","title":"Errors supported by the IdFix tool"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/#errors-supported-by-the-idfix-tool","text":"","title":"Errors supported by the IdFix tool"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/#multi-tenant-errors","text":"","title":"Multi-Tenant Errors"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/#all-objects","text":"Well known exclusions Admini* CAS_{* DiscoverySearchMailbox* FederatedEmail* Guest* HTTPConnector* krbtgt* iusr_* iwam* msol* support_* SystemMailbox* WWIOadmini* *$ distinguishedName contains \u201c\\0ACNF:\u201d contains IsCriticalSystemObject","title":"All objects"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/#mail","text":"no duplicates","title":"mail"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/#mailnickname","text":"may not begin with a period no duplicates","title":"mailNickName"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/#proxyaddresses","text":"invalid chars whitespace < > ( ) ; , [ ] \u201c rfc2822 & routable namespace (smtp only) no duplicates single value maximum number of characters: 256","title":"proxyAddresses"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/#samaccountname-only-if-no-userprincipalname-value","text":"invalid chars [ \\ \u201c | , / : < > + = ; ? * ] no duplicates maximum number of characters: 20","title":"sAMAccountName (only if no userPrincipalName value)"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/#targetaddress","text":"invalid chars whitespace \\ < > ( ) ; , [ ] \u201c rfc2822 & routable namespace (smtp only) no duplicates maximum number of characters: 255","title":"targetAddress"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/#userprincipalname","text":"invalid chars whitespace \\ % & * + / = ? { } | < > ( ) ; : , [ ] \u201c and umlaut rfc2822 & routable namespace format no duplicates maximum number of characters: 113 less than 64 before @ less than 48 after @","title":"userPrincipalName"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/#dedicated-errors","text":"","title":"Dedicated Errors"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/#all-objects_1","text":"Well known exclusions Admini* CAS_{* DiscoverySearchMailbox* FederatedEmail* Guest* HTTPConnector* krbtgt* iusr_* iwam* msol* support_* SystemMailbox* WWIOadmini* *$ distinguishedName contains \u201c\\0ACNF:\u201d contains IsCriticalSystemObject","title":"All objects"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/#displayname","text":"not blank (group) no leading or trailing white space less than 256","title":"displayName"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/#mail_1","text":"no white space rfc2822 & routable namespace no duplicates less than 256","title":"mail"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/#mailnickname_1","text":"not blank (contact and user) invalid chars whitespace \\ ! # $ % & * + / = ? ^ ` { } | ~ < > ( ) ' ; : , [ ] \" @ may not begin or end with a period less than 64","title":"mailNickName"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/#proxyaddresses_1","text":"DEPRECATED - no leading or trailing white space rfc2822 & routable namespace (smtp only) no duplicates single value maximum number of characters: 256","title":"proxyAddresses"},{"location":"Errors%20supported%20by%20the%20IdFix%20tool/#targetaddress_1","text":"not blank (contact and user without homeMdb) DEPRECATED - invalid chars whitespace rfc2822 & routable namespace (smtp only) DEPRECATED - no duplicates less than 256 value = mail (contact and user [if no homeMdb])","title":"targetAddress"},{"location":"Frequently%20asked%20questions%20%28FAQ%29/","text":"Frequently asked questions (FAQ) \u00b6 Feedback \u00b6 Bug reports and desired feature requests can be submitted to an issues list, https://github.com/Microsoft/idfix/issues, where it will be reviewed. We also happily accept pull requests containing new functionality or fixes . Performance \u00b6 IdFix performance will vary based on the hardware utilized and the network latency to the Active Directory global catalog (GC) server. Machines should have the minimum RAM specified and will benefit by using faster hard drives because temporary files are written to disk during the AD Query. Number of errors shown \u00b6 Customers with more than 50,000 errors returned might exceed physical memory in attempting to display all data at one time. To alleviate this issue, errors are broken into blocks of 50,000. Exceeding the block size enables the More Errors options of View Next Block and View Previous Block. Temporary files \u00b6 Large volumes of data may be parsed in the search for duplicate values. For instance, a user may have up to six attributes that must be checked and the proxyAddresses field can have many values. The duplicate check count may routinely exceed five times the number of objects returned. For this reason, data must be written to disk to avoid the out-of-memory exception on most workstations. Don\u2019t delete the temporary files while running. This will trigger an exception and might cause unpredictable results. Directory Exceptions \u00b6 There are 60 separate LDAP return codes and four types of directory exceptions that can occur when contacting a directory server. These should be gracefully handled with a message box and an error written to the log. Client-server timeout is one example where the condition might be sporadic. To alleviate this issue, the default LDAP time-out interval has been increased from 30 seconds to two minutes. This is a server-side limitation, and the application respects all server-side limits. If this should occur, then wait for a period of time when the GC is not so heavily utilized and/or launch the application from a lower-latency location. For example, directly on a global catalog server. Don\u2019t see updates in other domains \u00b6 If the response to an update was COMPLETE, then the value has been applied to the directory. However, you might need to wait for replication to complete. Attempting to apply the update multiple times in a row might result in an exception stating the server is unwilling to process the request. Run Query AD again and you should observe that the error has been resolved. FAIL (ACTION) \u00b6 Extensive efforts have been made to make the schema and value limits of the Active Directory unobtrusive. With that caveat, it is still possible for the value entered in the UPDATE column to conflict with a directory rule within AD. If the ACTION value on a row turns to FAIL, then there is an unknown conflict between the UPDATE column and the attribute values stored in the directory. These conflicts will require that the attribute values currently stored be examined more closely and might require ADSIEDIT to resolve. Double Byte Characters \u00b6 IdFix has not been localized and double byte characters have not been tested in the application. Please send any errors of this type to IdFixSupport@Microsoft.com for further investigation. Filtering \u00b6 The application allows the user to specify a directory branch to use to begin the subtree search for errors. Multiple subtrees are not supported, and the start point will be used by the Query function until changed in the Filter Subtree dialog. Filtering of values within the column is not supported as they can already be sorted. Selecting Import to use a manually edited file will reset the filter to the whole forest for the Query option. Sorting \u00b6 The data columns can be sorted by selecting the column header as is standard in DataGrid view UX behavior. Selecting again will reverse the sort. Export Data \u00b6 Use Export to export data. Import Data \u00b6 The ability to Import a CSV file is now supported. This feature is a use-at-your-own-risk option. While we\u2019ve created error and format handling functions to help populate the DataGrid correctly, there is no way to ensure that incorrect errors are not introduced by manually editing the file. Consider these best practice recommendations: \u2022 Use Excel to view and edit the source file. \u2022 Do not change the number of columns, headings, or any field values other than Update or Action. \u2022 Do not save the file with any format other than CSV. \u2022 Do not use escape characters in the field values.","title":"Frequently asked questions."},{"location":"Frequently%20asked%20questions%20%28FAQ%29/#frequently-asked-questions-faq","text":"","title":"Frequently asked questions (FAQ)"},{"location":"Frequently%20asked%20questions%20%28FAQ%29/#feedback","text":"Bug reports and desired feature requests can be submitted to an issues list, https://github.com/Microsoft/idfix/issues, where it will be reviewed. We also happily accept pull requests containing new functionality or fixes .","title":"Feedback"},{"location":"Frequently%20asked%20questions%20%28FAQ%29/#performance","text":"IdFix performance will vary based on the hardware utilized and the network latency to the Active Directory global catalog (GC) server. Machines should have the minimum RAM specified and will benefit by using faster hard drives because temporary files are written to disk during the AD Query.","title":"Performance"},{"location":"Frequently%20asked%20questions%20%28FAQ%29/#number-of-errors-shown","text":"Customers with more than 50,000 errors returned might exceed physical memory in attempting to display all data at one time. To alleviate this issue, errors are broken into blocks of 50,000. Exceeding the block size enables the More Errors options of View Next Block and View Previous Block.","title":"Number of errors shown"},{"location":"Frequently%20asked%20questions%20%28FAQ%29/#temporary-files","text":"Large volumes of data may be parsed in the search for duplicate values. For instance, a user may have up to six attributes that must be checked and the proxyAddresses field can have many values. The duplicate check count may routinely exceed five times the number of objects returned. For this reason, data must be written to disk to avoid the out-of-memory exception on most workstations. Don\u2019t delete the temporary files while running. This will trigger an exception and might cause unpredictable results.","title":"Temporary files"},{"location":"Frequently%20asked%20questions%20%28FAQ%29/#directory-exceptions","text":"There are 60 separate LDAP return codes and four types of directory exceptions that can occur when contacting a directory server. These should be gracefully handled with a message box and an error written to the log. Client-server timeout is one example where the condition might be sporadic. To alleviate this issue, the default LDAP time-out interval has been increased from 30 seconds to two minutes. This is a server-side limitation, and the application respects all server-side limits. If this should occur, then wait for a period of time when the GC is not so heavily utilized and/or launch the application from a lower-latency location. For example, directly on a global catalog server.","title":"Directory Exceptions"},{"location":"Frequently%20asked%20questions%20%28FAQ%29/#dont-see-updates-in-other-domains","text":"If the response to an update was COMPLETE, then the value has been applied to the directory. However, you might need to wait for replication to complete. Attempting to apply the update multiple times in a row might result in an exception stating the server is unwilling to process the request. Run Query AD again and you should observe that the error has been resolved.","title":"Don\u2019t see updates in other domains"},{"location":"Frequently%20asked%20questions%20%28FAQ%29/#fail-action","text":"Extensive efforts have been made to make the schema and value limits of the Active Directory unobtrusive. With that caveat, it is still possible for the value entered in the UPDATE column to conflict with a directory rule within AD. If the ACTION value on a row turns to FAIL, then there is an unknown conflict between the UPDATE column and the attribute values stored in the directory. These conflicts will require that the attribute values currently stored be examined more closely and might require ADSIEDIT to resolve.","title":"FAIL (ACTION)"},{"location":"Frequently%20asked%20questions%20%28FAQ%29/#double-byte-characters","text":"IdFix has not been localized and double byte characters have not been tested in the application. Please send any errors of this type to IdFixSupport@Microsoft.com for further investigation.","title":"Double Byte Characters"},{"location":"Frequently%20asked%20questions%20%28FAQ%29/#filtering","text":"The application allows the user to specify a directory branch to use to begin the subtree search for errors. Multiple subtrees are not supported, and the start point will be used by the Query function until changed in the Filter Subtree dialog. Filtering of values within the column is not supported as they can already be sorted. Selecting Import to use a manually edited file will reset the filter to the whole forest for the Query option.","title":"Filtering"},{"location":"Frequently%20asked%20questions%20%28FAQ%29/#sorting","text":"The data columns can be sorted by selecting the column header as is standard in DataGrid view UX behavior. Selecting again will reverse the sort.","title":"Sorting"},{"location":"Frequently%20asked%20questions%20%28FAQ%29/#export-data","text":"Use Export to export data.","title":"Export Data"},{"location":"Frequently%20asked%20questions%20%28FAQ%29/#import-data","text":"The ability to Import a CSV file is now supported. This feature is a use-at-your-own-risk option. While we\u2019ve created error and format handling functions to help populate the DataGrid correctly, there is no way to ensure that incorrect errors are not introduced by manually editing the file. Consider these best practice recommendations: \u2022 Use Excel to view and edit the source file. \u2022 Do not change the number of columns, headings, or any field values other than Update or Action. \u2022 Do not save the file with any format other than CSV. \u2022 Do not use escape characters in the field values.","title":"Import Data"},{"location":"Step%201%20-%20Review%20the%20prerequisites/","text":"Step 1: Review the prerequisites \u00b6 Ensure that the following prerequisites are in place: Minimum hardware requirements: \u00b6 A physical or virtual machine is required to run IdFix. The computer should minimally meet the following specifications: 4 GB RAM and 2 GB of hard disk space. Minimum software requirements: \u00b6 Operating system \u00b6 Windows Server 2008 R2 and Windows 7 for x64 bit versions or later versions of Windows and Windows Server. .NET Framework 4.0: .NET Framework 4.5.2 or later must be installed on the workstation running the application. Windows Server Active Directory \u00b6 Windows Server 2008 R2 or later versions. Don\u2019t install and run the IdFix tool on a domain controller. The IdFix tool will, however, function correctly on an Azure AD Connect server even after directory synchronization has already occurred. Exchange Server \u00b6 The messaging attributes retrieved are version independent and should work with Exchange 2003 or later. Permissions \u00b6 The application runs in the context of the authenticated user, which means that it will query the authenticated forest and must have rights to read the directory. If you want to apply changes to the directory, the authenticated user needs read/write permission to the desired objects. Note: IdFix does not need to be installed on the Exchange or Active Directory server. It merely needs to be installed on a workstation in the forest and have access to a global catalog server. Important: It is important that any identity management system in the on-premises Active Directory environment be evaluated to determine if it creates any conflicts with IdFix. The risk is that after correcting an error, an on-premises identity management system might update the attribute again, returning it to its original error state. Before implementing directory synchronization, it might be necessary to review or modify portions of existing identity management systems if they are repeatedly generating invalid attribute values.","title":"Step 1: Review the prerequisites"},{"location":"Step%201%20-%20Review%20the%20prerequisites/#step-1-review-the-prerequisites","text":"Ensure that the following prerequisites are in place:","title":"Step 1: Review the prerequisites"},{"location":"Step%201%20-%20Review%20the%20prerequisites/#minimum-hardware-requirements","text":"A physical or virtual machine is required to run IdFix. The computer should minimally meet the following specifications: 4 GB RAM and 2 GB of hard disk space.","title":"Minimum hardware requirements:"},{"location":"Step%201%20-%20Review%20the%20prerequisites/#minimum-software-requirements","text":"","title":"Minimum software requirements:"},{"location":"Step%201%20-%20Review%20the%20prerequisites/#operating-system","text":"Windows Server 2008 R2 and Windows 7 for x64 bit versions or later versions of Windows and Windows Server. .NET Framework 4.0: .NET Framework 4.5.2 or later must be installed on the workstation running the application.","title":"Operating system"},{"location":"Step%201%20-%20Review%20the%20prerequisites/#windows-server-active-directory","text":"Windows Server 2008 R2 or later versions. Don\u2019t install and run the IdFix tool on a domain controller. The IdFix tool will, however, function correctly on an Azure AD Connect server even after directory synchronization has already occurred.","title":"Windows Server Active Directory"},{"location":"Step%201%20-%20Review%20the%20prerequisites/#exchange-server","text":"The messaging attributes retrieved are version independent and should work with Exchange 2003 or later.","title":"Exchange Server"},{"location":"Step%201%20-%20Review%20the%20prerequisites/#permissions","text":"The application runs in the context of the authenticated user, which means that it will query the authenticated forest and must have rights to read the directory. If you want to apply changes to the directory, the authenticated user needs read/write permission to the desired objects. Note: IdFix does not need to be installed on the Exchange or Active Directory server. It merely needs to be installed on a workstation in the forest and have access to a global catalog server. Important: It is important that any identity management system in the on-premises Active Directory environment be evaluated to determine if it creates any conflicts with IdFix. The risk is that after correcting an error, an on-premises identity management system might update the attribute again, returning it to its original error state. Before implementing directory synchronization, it might be necessary to review or modify portions of existing identity management systems if they are repeatedly generating invalid attribute values.","title":"Permissions"},{"location":"Step%202%20-%20Install%20IdFix/","text":"Step 2: Install IdFix \u00b6 Select setup.exe to download and install the IdFix tool on your Windows machine. The following prerequisites will be installed if they are not already present on your machine: \u2022 Microsoft .NET Framework 4.5.2 \u2022 Windows Installer 5.0 Run and install updates \u00b6 After installing the application, you can run it from your Windows machine by searching for it in the Start menu. Each time the application is run, it will check for any updates and then launch. Uninstall \u00b6 You can uninstall the application at any time using the standard Windows Add or remove programs window. Resources \u00b6 \u2022 ClickOnce and .NET Framework Resources \u2022 Report an issue","title":"Step 2: Install IdFix"},{"location":"Step%202%20-%20Install%20IdFix/#step-2-install-idfix","text":"Select setup.exe to download and install the IdFix tool on your Windows machine. The following prerequisites will be installed if they are not already present on your machine: \u2022 Microsoft .NET Framework 4.5.2 \u2022 Windows Installer 5.0","title":"Step 2: Install IdFix"},{"location":"Step%202%20-%20Install%20IdFix/#run-and-install-updates","text":"After installing the application, you can run it from your Windows machine by searching for it in the Start menu. Each time the application is run, it will check for any updates and then launch.","title":"Run and install updates"},{"location":"Step%202%20-%20Install%20IdFix/#uninstall","text":"You can uninstall the application at any time using the standard Windows Add or remove programs window.","title":"Uninstall"},{"location":"Step%202%20-%20Install%20IdFix/#resources","text":"\u2022 ClickOnce and .NET Framework Resources \u2022 Report an issue","title":"Resources"},{"location":"Step%203%20-%20Query%20and%20fix%20invalid%20attributes/","text":"Step 3: Query and fix invalid attributes \u00b6 Log on to the Windows machine where you installed the IdFix tool using an account that has read/write permissions to your on-premises Active Directory objects. Directory synchronization rule sets are different depending on which version of Microsoft 365 is in use. Use Settings to choose between running the Multi-Tenant or Dedicated/ITAR rule sets to detect attribute values known to cause directory synchronization errors relevant to the version of Office 365 in use. The scope of the query can be limited by selecting Settings and entering a valid directory path in the Filter field to use as a start for the subtree search. Only one starting point can be designated at a time. The subtree point will be used for all successive queries until changed. Deleting the value will reset the query to the whole forest. The value must be entered in the format OU=myOu,DC=Contoso,DC=com. Select Query to query for objects containing invalid attributes that will cause directory synchronization errors. IdFix queries all objects with a filter for applicable attributes. IdFix updates the status line on the bottom of the DataGrid view and writes all values to the log. If you don\u2019t want to continue, you can select Cancel to terminate a running query. IdFix applies rules against the required AD attributes to determine which objects must be remediated and presents you with any detected error conditions. IdFix displays items with information related to the object in question and the error conditions. Objects are identified by the distinguishedName field with the associated error type and value that is in error. Where feasible, IdFix presents a recommendation for corrective data in the UPDATE column. Recommendations are based on a \u201cbest effort\u201d approach for the specific object in question. Because recommendations are object specific, they are not checked against the existing data set and might introduce additional errors. For certain types of errors (duplicates and format errors), a recommendation for correction is not provided. Corrective information must be manually entered to correct the issue. In the event that multiple errors are associated with a single attribute, errors are combined into a single line item. If a blank DataGrid is displayed after execution, then no errors were returned. This is a good thing. To correct the object attribute values, select one of the following options from the ACTION dropdown list: COMPLETE The original value is acceptable and should not be changed despite being identified as being in an error state. For example, two users may have a proxyAddress identified as duplicate. Only one can use the value for mail delivery. The user with the correct value should be marked as COMPLETE, while the other user is marked as REMOVE. REMOVE The attribute value will be cleared from the source object. In the case of a multi-valued attribute; e.g. proxyAddresses, only the individual value shown will be cleared. EDIT The information in the UPDATE column will be used to modify the attribute value for the selected object. In many cases, a valid update value has been predetermined. In these cases, you can mark the ACTION as EDIT and go on to the next error. If the predetermined update value is not desired, you can manually input the new value. UNDO This value is only shown if the user has loaded a previously saved Update file. The sole operation that can be executed is to restore the original value. FAIL This value is only shown if an update value has an unknown conflict with the directory rules. In this case, you may attempt to edit the value again. It may be necessary to analyze the values in the object using ADSIEDIT. Only errors where you have selected an action will be considered for update. To reiterate: unless a specific choice is made in the ACTION column , IdFix will not perform any operation on the error. The option to Accept all suggested updates is available. After selecting the ACTION for one or more errors, select Apply to write the values to Active Directory. Successful writes are indicated by displaying \u201cCOMPLETE\u201d in the ACTION column. IdFix writes all UPDATE transactions to a transaction log. The following is an example. 7/22/2021 6:36:44 AM INITIALIZED - IDFIX VERSION 2.0.0 - MULTI-TENANT 7/22/2021 6:36:47 AM QUERY AD 7/22/2021 6:36:47 AM FOREST:E2K10.COM SERVER:DC1.E2K10.COM FILTER:(|(OBJECTCATEGORY=PERSON)(OBJECTCATEGORY=GROUP)) 7/22/2021 6:36:47 AM PLEASE WAIT WHILE THE LDAP CONNECTION IS ESTABLISHED. 7/22/2021 6:36:49 AM QUERY COUNT: 140 ERROR COUNT: 29 DUPLICATE CHECK COUNT: 191 7/22/2021 6:36:49 AM ELAPSED TIME: AD QUERY - 00:00:02.3890432 7/22/2021 6:36:49 AM WRITE SPLIT FILES 7/22/2021 6:36:49 AM MERGE SPLIT FILES 7/22/2021 6:36:49 AM COUNT DUPLICATES 7/22/2021 6:36:49 AM WRITE FILTERED DUPLICATE OBJECTS 7/22/2021 6:36:49 AM READ FILTERED DUPLICATE OBJECTS 7/22/2021 6:36:49 AM READ ERROR FILE 7/22/2021 6:36:49 AM ELAPSED TIME: DUPLICATE CHECKS - 00:00:00.0780785 7/22/2021 6:36:49 AM POPULATING DATAGRID 7/22/2021 6:36:50 AM ELAPSED TIME: POPULATE DATAGRIDVIEW - 00:00:00.0780785 7/22/2021 6:36:50 AM QUERY COUNT: 140 ERROR COUNT: 53 7/22/2021 6:37:34 AM APPLY PENDING 7/22/2021 6:37:34 AM UPDATE: [CN=USER000001,OU=E2K10OU1,DC=E2K10,DC=COM][USER][MAILNICKNAME][CHARACTER][USER?^|000001][USER000001][EDIT] 7/22/2021 6:37:34 AM UPDATE: [CN=USER000008,OU=E2K10OU1,DC=E2K10,DC=COM][USER][TARGETADDRESS][DUPLICATE][SMTP:USER000008@CUSTOMER.COM][][REMOVE] 7/22/2021 6:37:34 AM COMPLETE 7/22/2021 6:37:40 AM LOADING UPDATES 7/22/2021 6:37:40 AM ACTION SELECTION 7/22/2021 6:37:57 AM APPLY PENDING 7/22/2021 6:37:57 AM UPDATE: [CN=USER000001,OU=E2K10OU1,DC=E2K10,DC=COM][USER][MAILNICKNAME][CHARACTER][USER?^|000001][USER000001][UNDO] 7/22/2021 6:37:57 AM UPDATE: [CN=USER000008,OU=E2K10OU1,DC=E2K10,DC=COM][USER][TARGETADDRESS][DUPLICATE][SMTP:USER000008@CUSTOMER.COM][][UNDO] 7/22/2021 6:37:57 AM COMPLETE In the event of an unwanted correction, you may perform a transaction update undo one level deep per UPDATE transaction. a. Apply generates a LDF file for the transactions that are applied. b. To Undo a transaction, select the LDF file that contains the appropriate transaction and reload it into the table. Note: IdFix can\u2019t track updates to objects or attributes that occur outside the application. If you and someone else edit the same attribute, then the last change is the one committed to the object. You can Export what\u2019s in the table to review with others before taking corrective action, or to use as the source of a later bulk import using a separate utility like CSVDE or LDIFDE. Testing is strongly recommended, no matter which tool you use. You also can Import data from a CSV file to allow offline manual edits to be applied. Be very careful with manually edited files and use an Exported CSV file as a template. Testing is strongly recommended and there is no guarantee that what you do offline will be correctly recognized by IdFix. If the query returns more than 50,000 errors, the menu items Next Block and Previous Block are displayed. The number of errors that can be displayed on the screen at one time is limited to avoid application exceptions resulting from exceeding physical memory. You may always submit suggestions for improvement or support requests via the issues list . Explanations of errors \u00b6 For details on the errors that apply to each attribute see the Errors supported by the IdFix tool section in the Appendix. Character The Value contains a character which is invalid. The suggested Update will show the value with the character removed. Format The Value violates the format requirements for the attribute usage. The suggested Update will show the Value with any invalid characters removed. If there are no invalid characters the Update and Value will appear the same. It is up to the user to determine what they really want in the Update. For example SMTP addresses must comply with rfc 2822 and mailNickName cannot start or end with a period. TopLevelDomain This applies to values subject to rfc2822 formatting. If the top level domain is not internet routable then this will be identified as an error. For example a smtp address ending in .local is not internet routable and would cause this error. DomainPart This applies to values subject to rfc2822 formatting. If the domain portion of the value is invalid beyond the top level domain routing this will be generated. LocalPart This applies to values subject to rfc2822 formatting. If the local portion of the value is invalid this will be generated. Length The Value violates the length limit for the attribute. This is most commonly encountered when the schema has been altered. The suggested Update will truncate the value to the attribute standard length. Duplicate The Value has a duplicate within the scope of the query. All duplicate values will be displayed as errors. The user can Edit or Remove values to eliminate duplication. Blank The Value violates the null restriction for attributes to be synchronized. Only a few values must contain a value. The suggested Update will leverage other attribute values in order to generate a likely substitute. MailMatch This applies to Dedicated only. The Value does not match the mail attribute. The suggested Update will be the mail attribute value prefixed by \u201cSMTP:\u201d.","title":"Step 3: Query and fix invalid attributes"},{"location":"Step%203%20-%20Query%20and%20fix%20invalid%20attributes/#step-3-query-and-fix-invalid-attributes","text":"Log on to the Windows machine where you installed the IdFix tool using an account that has read/write permissions to your on-premises Active Directory objects. Directory synchronization rule sets are different depending on which version of Microsoft 365 is in use. Use Settings to choose between running the Multi-Tenant or Dedicated/ITAR rule sets to detect attribute values known to cause directory synchronization errors relevant to the version of Office 365 in use. The scope of the query can be limited by selecting Settings and entering a valid directory path in the Filter field to use as a start for the subtree search. Only one starting point can be designated at a time. The subtree point will be used for all successive queries until changed. Deleting the value will reset the query to the whole forest. The value must be entered in the format OU=myOu,DC=Contoso,DC=com. Select Query to query for objects containing invalid attributes that will cause directory synchronization errors. IdFix queries all objects with a filter for applicable attributes. IdFix updates the status line on the bottom of the DataGrid view and writes all values to the log. If you don\u2019t want to continue, you can select Cancel to terminate a running query. IdFix applies rules against the required AD attributes to determine which objects must be remediated and presents you with any detected error conditions. IdFix displays items with information related to the object in question and the error conditions. Objects are identified by the distinguishedName field with the associated error type and value that is in error. Where feasible, IdFix presents a recommendation for corrective data in the UPDATE column. Recommendations are based on a \u201cbest effort\u201d approach for the specific object in question. Because recommendations are object specific, they are not checked against the existing data set and might introduce additional errors. For certain types of errors (duplicates and format errors), a recommendation for correction is not provided. Corrective information must be manually entered to correct the issue. In the event that multiple errors are associated with a single attribute, errors are combined into a single line item. If a blank DataGrid is displayed after execution, then no errors were returned. This is a good thing. To correct the object attribute values, select one of the following options from the ACTION dropdown list: COMPLETE The original value is acceptable and should not be changed despite being identified as being in an error state. For example, two users may have a proxyAddress identified as duplicate. Only one can use the value for mail delivery. The user with the correct value should be marked as COMPLETE, while the other user is marked as REMOVE. REMOVE The attribute value will be cleared from the source object. In the case of a multi-valued attribute; e.g. proxyAddresses, only the individual value shown will be cleared. EDIT The information in the UPDATE column will be used to modify the attribute value for the selected object. In many cases, a valid update value has been predetermined. In these cases, you can mark the ACTION as EDIT and go on to the next error. If the predetermined update value is not desired, you can manually input the new value. UNDO This value is only shown if the user has loaded a previously saved Update file. The sole operation that can be executed is to restore the original value. FAIL This value is only shown if an update value has an unknown conflict with the directory rules. In this case, you may attempt to edit the value again. It may be necessary to analyze the values in the object using ADSIEDIT. Only errors where you have selected an action will be considered for update. To reiterate: unless a specific choice is made in the ACTION column , IdFix will not perform any operation on the error. The option to Accept all suggested updates is available. After selecting the ACTION for one or more errors, select Apply to write the values to Active Directory. Successful writes are indicated by displaying \u201cCOMPLETE\u201d in the ACTION column. IdFix writes all UPDATE transactions to a transaction log. The following is an example. 7/22/2021 6:36:44 AM INITIALIZED - IDFIX VERSION 2.0.0 - MULTI-TENANT 7/22/2021 6:36:47 AM QUERY AD 7/22/2021 6:36:47 AM FOREST:E2K10.COM SERVER:DC1.E2K10.COM FILTER:(|(OBJECTCATEGORY=PERSON)(OBJECTCATEGORY=GROUP)) 7/22/2021 6:36:47 AM PLEASE WAIT WHILE THE LDAP CONNECTION IS ESTABLISHED. 7/22/2021 6:36:49 AM QUERY COUNT: 140 ERROR COUNT: 29 DUPLICATE CHECK COUNT: 191 7/22/2021 6:36:49 AM ELAPSED TIME: AD QUERY - 00:00:02.3890432 7/22/2021 6:36:49 AM WRITE SPLIT FILES 7/22/2021 6:36:49 AM MERGE SPLIT FILES 7/22/2021 6:36:49 AM COUNT DUPLICATES 7/22/2021 6:36:49 AM WRITE FILTERED DUPLICATE OBJECTS 7/22/2021 6:36:49 AM READ FILTERED DUPLICATE OBJECTS 7/22/2021 6:36:49 AM READ ERROR FILE 7/22/2021 6:36:49 AM ELAPSED TIME: DUPLICATE CHECKS - 00:00:00.0780785 7/22/2021 6:36:49 AM POPULATING DATAGRID 7/22/2021 6:36:50 AM ELAPSED TIME: POPULATE DATAGRIDVIEW - 00:00:00.0780785 7/22/2021 6:36:50 AM QUERY COUNT: 140 ERROR COUNT: 53 7/22/2021 6:37:34 AM APPLY PENDING 7/22/2021 6:37:34 AM UPDATE: [CN=USER000001,OU=E2K10OU1,DC=E2K10,DC=COM][USER][MAILNICKNAME][CHARACTER][USER?^|000001][USER000001][EDIT] 7/22/2021 6:37:34 AM UPDATE: [CN=USER000008,OU=E2K10OU1,DC=E2K10,DC=COM][USER][TARGETADDRESS][DUPLICATE][SMTP:USER000008@CUSTOMER.COM][][REMOVE] 7/22/2021 6:37:34 AM COMPLETE 7/22/2021 6:37:40 AM LOADING UPDATES 7/22/2021 6:37:40 AM ACTION SELECTION 7/22/2021 6:37:57 AM APPLY PENDING 7/22/2021 6:37:57 AM UPDATE: [CN=USER000001,OU=E2K10OU1,DC=E2K10,DC=COM][USER][MAILNICKNAME][CHARACTER][USER?^|000001][USER000001][UNDO] 7/22/2021 6:37:57 AM UPDATE: [CN=USER000008,OU=E2K10OU1,DC=E2K10,DC=COM][USER][TARGETADDRESS][DUPLICATE][SMTP:USER000008@CUSTOMER.COM][][UNDO] 7/22/2021 6:37:57 AM COMPLETE In the event of an unwanted correction, you may perform a transaction update undo one level deep per UPDATE transaction. a. Apply generates a LDF file for the transactions that are applied. b. To Undo a transaction, select the LDF file that contains the appropriate transaction and reload it into the table. Note: IdFix can\u2019t track updates to objects or attributes that occur outside the application. If you and someone else edit the same attribute, then the last change is the one committed to the object. You can Export what\u2019s in the table to review with others before taking corrective action, or to use as the source of a later bulk import using a separate utility like CSVDE or LDIFDE. Testing is strongly recommended, no matter which tool you use. You also can Import data from a CSV file to allow offline manual edits to be applied. Be very careful with manually edited files and use an Exported CSV file as a template. Testing is strongly recommended and there is no guarantee that what you do offline will be correctly recognized by IdFix. If the query returns more than 50,000 errors, the menu items Next Block and Previous Block are displayed. The number of errors that can be displayed on the screen at one time is limited to avoid application exceptions resulting from exceeding physical memory. You may always submit suggestions for improvement or support requests via the issues list .","title":"Step 3: Query and fix invalid attributes"},{"location":"Step%203%20-%20Query%20and%20fix%20invalid%20attributes/#explanations-of-errors","text":"For details on the errors that apply to each attribute see the Errors supported by the IdFix tool section in the Appendix. Character The Value contains a character which is invalid. The suggested Update will show the value with the character removed. Format The Value violates the format requirements for the attribute usage. The suggested Update will show the Value with any invalid characters removed. If there are no invalid characters the Update and Value will appear the same. It is up to the user to determine what they really want in the Update. For example SMTP addresses must comply with rfc 2822 and mailNickName cannot start or end with a period. TopLevelDomain This applies to values subject to rfc2822 formatting. If the top level domain is not internet routable then this will be identified as an error. For example a smtp address ending in .local is not internet routable and would cause this error. DomainPart This applies to values subject to rfc2822 formatting. If the domain portion of the value is invalid beyond the top level domain routing this will be generated. LocalPart This applies to values subject to rfc2822 formatting. If the local portion of the value is invalid this will be generated. Length The Value violates the length limit for the attribute. This is most commonly encountered when the schema has been altered. The suggested Update will truncate the value to the attribute standard length. Duplicate The Value has a duplicate within the scope of the query. All duplicate values will be displayed as errors. The user can Edit or Remove values to eliminate duplication. Blank The Value violates the null restriction for attributes to be synchronized. Only a few values must contain a value. The suggested Update will leverage other attribute values in order to generate a likely substitute. MailMatch This applies to Dedicated only. The Value does not match the mail attribute. The suggested Update will be the mail attribute value prefixed by \u201cSMTP:\u201d.","title":"Explanations of errors"},{"location":"build-docs/","text":"Building the Documentation \u00b6 Building the documentation locally can help you visualize change you are making to the docs. What you see locally should be what you see online. Building \u00b6 Documentation is built using MkDocs. You will need to latest version of Python (tested on version 3.7.1) and pip. If you're on the Windows operating system, make sure you have added Python to your Path environment variable . When executing the pip module on Windows you can prefix it with python -m . For example: python -m pip install mkdocs-material Install MkDocs pip install mkdocs Install the Material theme pip install mkdocs-material install the mkdocs-markdownextradata-plugin - this is used for the version variable pip install mkdocs-markdownextradata-plugin (doesn't work on Python v2.7) Serve it up mkdocs serve Open a browser to http://127.0.0.1:8000","title":"Build Documentation"},{"location":"build-docs/#building-the-documentation","text":"Building the documentation locally can help you visualize change you are making to the docs. What you see locally should be what you see online.","title":"Building the Documentation"},{"location":"build-docs/#building","text":"Documentation is built using MkDocs. You will need to latest version of Python (tested on version 3.7.1) and pip. If you're on the Windows operating system, make sure you have added Python to your Path environment variable . When executing the pip module on Windows you can prefix it with python -m . For example: python -m pip install mkdocs-material Install MkDocs pip install mkdocs Install the Material theme pip install mkdocs-material install the mkdocs-markdownextradata-plugin - this is used for the version variable pip install mkdocs-markdownextradata-plugin (doesn't work on Python v2.7) Serve it up mkdocs serve Open a browser to http://127.0.0.1:8000","title":"Building"}]}